(namespace actor)

(load "./actor/meta" "./interface/meta")
(import-namespace interface)

(load  "./event-emitter" "./interface")

(def resolve (v)  (.resolve Promise v))

(def-interface Actor ((promise (resolve)))
  (extend Event-emitter )

  (init (.call Emitter.init this)
        (.on this 'error (=> (e) (assign this.promise (resolve)))))

  (def send (msg)
    (enque-task this.promise
                (.emit this 'message msg))))

(export Actor)
