(namespace repl)

(include "@kit-js/core/header")
(import-namespace kit)

(include "../meta")
(import-namespace meta)

(include "@kit-js/interface/header")

(import-namespace interface )

(include "@kit-js/async/header")
(import-namespace async)

(require! 'sibilant)

(define Compiler Actor

  (init () (.call Actor.init this))
  (def-generic *send (data)
    (pipe (Promise.resolve data)
          (.then (#-> .to-string sibilant (get  'js )))
          (.then (R.tap (emit 'message this)))
          (.catch (=> (e)
                      (.emit this 'error e)
                      (throw e)))))
  (def-generic spawn ()
    ((create this))))



(export Compiler)
