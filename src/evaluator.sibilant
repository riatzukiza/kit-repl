
(def-curried run-in (context string )
  (.run-in-context vm  string context))

(def-actor Evaluator (context)

  (def-generic spawn () ((create this)))

  (def-generic start () (.on this 'message (#-> this.eval)))
  (def-generic stop ())

  (def-generic eval (js context)
    (pipe (resolve js)
          (.then  (run-in context))
          (.then (#-> inspect (this.emit 'log)))
          (.catch (#-> inspect (this.emit 'error))))))
