(include "../src/meta")

(import-namespace meta)
(include "kit/sib/natives")

(reload "kit-interface/header"
        "../src/actor"
        "../src/repl/compiler"
        "../src/repl/reader"
        "../src/repl/evaluator"
        "../src/layer")

(define REPL (Layer.of [Reader Compiler Evaluator])
  (init ()
        (.call Layer.init this)
        (.on this 'message (=> ([type value]) (.emit this type value)))))

(let ((repl (.start ((create REPL)))))


  (assign sibilant.dir "./tests")

  (.on repl 'result (aprint "return from repl"))

  (.send repl "(print 'yo)")
  (.send repl "(+ 2 2)"))

